<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboards</title>
    <link id="favicon" rel="icon" href="img/icon-black.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div>
                <div class="menu-header" style="margin-bottom: 10px;">
                    <i class="fa-solid fa-layer-group" style="margin-right: 10px;"></i>Dashboards
                </div>
                <div class="menu-item" onclick="toggleMenu('loss-menu')">
                    <span><i class="fas fa-chart-bar" style="margin-right: 5px;"></i> ยอดสูญหาย</span>
                    <i class="fas fa-angle-down"></i>
                </div>
                <div class="submenu" id="loss-menu">
                    <div class="submenu-item" onclick="changeIframeSrc('https://docs.google.com/spreadsheets/d/1ea57VM8-W79BSIGw884niNYDiIQwptzoSwOuXhWLGsM/edit?rm=minimal&gridlines=0#gid=1435556747', 'รายงานยอดสูญหาย')">รายงานยอดสูญหาย</div>
                    <div class="submenu-item" onclick="changeIframeSrc('https://docs.google.com/spreadsheets/d/1ea57VM8-W79BSIGw884niNYDiIQwptzoSwOuXhWLGsM/edit?rm=minimal&gridlines=0#gid=2026076704', 'ตารางยอดสูญหาย')">ตารางยอดสูญหาย</div>
                    <div class="submenu-item" onclick="changeIframeSrc('https://docs.google.com/spreadsheets/d/1ea57VM8-W79BSIGw884niNYDiIQwptzoSwOuXhWLGsM/edit?rm=minimal&gridlines=0#gid=794424016', 'รายละเอียดยอดสูญหาย')">รายละเอียดยอดสูญหาย</div>
                </div>
                <!-- ... More menus ... -->
            </div>
            <div class="sidebar-footer">
                <img src="img/lowcode.svg" alt="powered by lowcode" style="height: 12px;">
            </div>
        </div>

        <div class="content">
            <div class="header">
                <div class="menu-title"><i class="fas fa-chart-bar" style="margin-right: 6px;"></i>รายงานยอดสูญหาย</div>
                <div class="logo-container">
                    <div style="font-size: 0.5rem; color: #888;">powered by</div>
                    <img id="google-sheets-logo" src="img/google_sheets_logo.svg" alt="Google Sheets Logo" class="logo">
                </div>
            </div>
            <div class="iframe-container">
                <iframe id="iframe-content" src="https://docs.google.com/spreadsheets/d/1ea57VM8-W79BSIGw884niNYDiIQwptzoSwOuXhWLGsM/edit?rm=minimal&gridlines=0#gid=1435556747"></iframe>
            </div>
        </div>
    </div>

    <script>
        function toggleMenu(menuId) {
            const submenu = document.getElementById(menuId);
            submenu.classList.toggle('open');
        }

        function changeIframeSrc(url, menuTitle) {
            const iframe = document.getElementById('iframe-content');
            const title = document.querySelector('.menu-title');
            iframe.src = url;
            if (menuTitle) {
                let icon = '';
                if (['รายงานยอดสูญหาย', 'ตารางยอดสูญหาย', 'รายละเอียดยอดสูญหาย'].includes(menuTitle)) {
                    icon = '<i class="fas fa-chart-bar" style="margin-right: 6px;"></i>';
                }
                title.innerHTML = icon + menuTitle;
            }
        }

        function updateFavicon() {
            const favicon = document.getElementById("favicon");
            const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)").matches;
            favicon.href = prefersDarkScheme ? "img/icon-white.ico" : "img/icon-black.ico";
        }

        document.getElementById("google-sheets-logo").addEventListener("click", function () {
            const iframe = document.getElementById("iframe-content");
            const currentSrc = iframe.src;
            if (currentSrc) {
                window.open(currentSrc, "_blank");
            }
        });

        updateFavicon();
        window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", updateFavicon);
    </script>
</body>
</html>
